import{J as S,K as Z,r as ee,a5 as ae,p as te,a6 as R,m as se,a as le,g as ie,l as re,X as ne,d as oe,b as ue,y as de,s as ce,f as w,a7 as ge,e as P,a8 as D,t as y,u as ve,c as i,v as k,a9 as M,A as B,_ as G,B as O,D as $,E as fe,G as c,F as me,H as K,N as L,M as x,I as pe,L as E}from"./index-82e8bfa7.js";import{r as he}from"./filters-501557af.js";import{V as be}from"./VDataTableServer-1c6d3a8a.js";import{V as ye}from"./VDialog-07690a70.js";import{V as F}from"./VContainer-ab4a1db7.js";import{a as Pe,c as Ve,b as Ue,d as _e,V as Se}from"./VCard-1d6d09e8.js";import{g as q}from"./filter-2328cb3f.js";import{V as b}from"./VBtn-94554fdc.js";import{a as z,V as C}from"./VRow-b0f7e36e.js";import{V as ke}from"./VTextField-3bbe9387.js";import{m as Le,j as Re,a as De,b as xe,k as Ae,l as Ce}from"./index-60619a3d.js";import{m as $e}from"./tag-c3595aa8.js";import"./VOverlay-f1d929c1.js";import"./VInput-29ae72a2.js";import"./index-eb4358f1.js";import"./VAvatar-7679238b.js";import"./scopeId-750b4cc2.js";import"./ssrBoot-a824542f.js";/* empty css              */const Ee={namespaced:!0,state:()=>({userPage:{docs:[],totalDocs:0,limit:10,hasPrevPage:!1,hasNextPage:!1,page:void 0,totalPages:0,offset:0,prevPage:void 0,nextPage:void 0,pagingCounter:0}}),getters:{getUser:e=>t=>e.userPage.docs.find(a=>a._id===t),userPage:e=>e.userPage},mutations:{ADD_USER:(e,t)=>{let a=-1;e.userPage.docs.map((n,s)=>{n._id===t._id&&(a=s)}),a===-1?e.userPage.docs.push(t):e.userPage.docs[a]=t},SET_USER_PAGE:(e,t)=>{e.userPage=t},REMOVE_USER(e,t){let a=-1;e.userPage.docs.map((n,s)=>{n._id===t._id&&(a=s)}),a>-1&&e.userPage.docs.splice(a,1)}},actions:{async fetchUser(e,t=""){return await S.get(`/v1/user${t}`).then(a=>(e.commit("ADD_USER",a.data),a.data)).catch(a=>{var n,s,r;e.dispatch("setToast",{title:"Request failed!",type:"error",text:(r=(s=(n=a.response)==null?void 0:n.data)==null?void 0:s.error)==null?void 0:r.message},{root:!0})})},async fetchUserList(e,t=""){return await S.get(`/v1/user${t}`).then(a=>(e.commit("SET_USER_PAGE",a.data),a.data)).catch(a=>{var n,s,r;e.dispatch("setToast",{title:"Request failed!",type:"error",text:(r=(s=(n=a.response)==null?void 0:n.data)==null?void 0:s.error)==null?void 0:r.message},{root:!0})})},async createUser(e,t){return await S.post("/v1/user",t).then(a=>(e.commit("ADD_USER",a.data),e.dispatch("setToast",{title:"Success",type:"success",text:"User created"},{root:!0}),a.data)).catch(a=>{var n,s,r;e.dispatch("setToast",{title:"Request failed!",type:"error",text:(r=(s=(n=a.response)==null?void 0:n.data)==null?void 0:s.error)==null?void 0:r.message},{root:!0})})},async updateUser(e,t){return await S.put("/v1/user",t).then(a=>(e.commit("ADD_USER",a.data),e.dispatch("setToast",{title:"Success",type:"success",text:"User updated"},{root:!0}),a.data)).catch(a=>{var n,s,r;e.dispatch("setToast",{title:"Request failed!",type:"error",text:(r=(s=(n=a.response)==null?void 0:n.data)==null?void 0:s.error)==null?void 0:r.message},{root:!0})})},deleteUser(e,t){S.delete(`/v1/user${t}`).then(a=>{e.commit("REMOVE_USER",a.data),e.dispatch("setToast",{title:"Success",type:"success",text:"User deleted"},{root:!0})}).catch(a=>{var n,s,r;e.dispatch("setToast",{title:"Request failed!",type:"error",text:(r=(s=(n=a.response)==null?void 0:n.data)==null?void 0:s.error)==null?void 0:r.message},{root:!0})})}}},Ie=Ee,{mapGetters:Te,mapActions:Ne}=Z("USER_LIST"),we={name:"UserList",components:{VDataTableServer:be},data:()=>({updatelUserDialog:!1,user:void 0,status:"",role:"",headers:[{key:"fullName",title:"Name",sortable:!0},{key:"email",title:"Email"},{key:"phoneNumber",title:"Phone"},{key:"role",title:"Role"},{key:"createdAt",title:"Created On"},{key:"status",title:"Status"},{key:"action",title:"Action"}],limit:10,hasPrevPage:!1,hasNextPage:!1,page:1,totalPages:0,loading:!1}),created(){this.fetchUsers()},computed:{...Te(["userPage"])},methods:{...Ne(["fetchUserList","updateUser"]),readableDate:he,searchUser(e){const t=e.target.value;t?this.fetchUsers(`&q=${t}`):this.fetchUsers()},fetchUsers(e=""){this.loading=!0;const t=`?limit=${this.limit}&page=${this.page}`+e;this.fetchUserList(t).then(a=>{a&&(this.page=a.page,this.limit=a.limit,this.loading=!1)})},setOptions(e){this.page=e.page,this.limit=e.itemsPerPage,this.fetchUsers()},saveUser(){var e;this.updateUser({userId:(e=this.user)==null?void 0:e._id,status:this.status,role:this.role}).then(t=>{t&&(this.updatelUserDialog=!1)})},update(e){this.updatelUserDialog=!0,this.status=e.status,this.role=e.role,this.user=e}},beforeCreate(){this.$store.hasModule("USER_LIST")||this.$store.registerModule("USER_LIST",Ie)},beforeUnmount(){this.$store.unregisterModule("USER_LIST")}};function Me(){const e=ee([]);ae(()=>e.value=[]);function t(a,n){e.value[n]=a}return{refs:e,updateRef:t}}const Be=te({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:R,default:"$first"},prevIcon:{type:R,default:"$prev"},nextIcon:{type:R,default:"$next"},lastIcon:{type:R,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...Le(),...se(),...Re(),...De(),...xe(),...Ae(),...$e({tag:"nav"}),...le(),...Ce({variant:"text"})},"VPagination"),Fe=ie()({name:"VPagination",props:Be(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,t){let{slots:a,emit:n}=t;const s=re(e,"modelValue"),{t:r,n:V}=ne(),{isRtl:o}=oe(),{themeClasses:I}=ue(e),{width:Y}=de(),A=ce(-1);w(void 0,{scoped:!0});const{resizeRef:j}=ge(l=>{if(!l.length)return;const{target:u,contentRect:d}=l[0],f=u.querySelector(".v-pagination__list > *");if(!f)return;const m=d.width,_=f.offsetWidth+parseFloat(getComputedStyle(f).marginRight)*2;A.value=T(m,_)}),g=P(()=>parseInt(e.length,10)),v=P(()=>parseInt(e.start,10)),p=P(()=>e.totalVisible?parseInt(e.totalVisible,10):A.value>=0?A.value:T(Y.value,58));function T(l,u){const d=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(+((l-u*d)/u).toFixed(2)))}const H=P(()=>{if(g.value<=0||isNaN(g.value)||g.value>Number.MAX_SAFE_INTEGER)return[];if(p.value<=1)return[s.value];if(g.value<=p.value)return D(g.value,v.value);const l=p.value%2===0,u=l?p.value/2:Math.floor(p.value/2),d=l?u:u+1,f=g.value-u;if(d-s.value>=0)return[...D(Math.max(1,p.value-1),v.value),e.ellipsis,g.value];if(s.value-f>=(l?1:0)){const m=p.value-1,_=g.value-m+v.value;return[v.value,e.ellipsis,...D(m,_)]}else{const m=Math.max(1,p.value-3),_=m===1?s.value:s.value-Math.ceil(m/2)+v.value;return[v.value,e.ellipsis,...D(m,_),e.ellipsis,g.value]}});function U(l,u,d){l.preventDefault(),s.value=u,d&&n(d,u)}const{refs:W,updateRef:X}=Me();w({VPaginationBtn:{color:y(e,"color"),border:y(e,"border"),density:y(e,"density"),size:y(e,"size"),variant:y(e,"variant"),rounded:y(e,"rounded"),elevation:y(e,"elevation")}});const J=P(()=>H.value.map((l,u)=>{const d=f=>X(f,u);if(typeof l=="string")return{isActive:!1,key:`ellipsis-${u}`,page:l,props:{ref:d,ellipsis:!0,icon:!0,disabled:!0}};{const f=l===s.value;return{isActive:f,key:l,page:V(l),props:{ref:d,ellipsis:!1,icon:!0,disabled:!!e.disabled||+e.length<2,color:f?e.activeColor:e.color,ariaCurrent:f,ariaLabel:r(f?e.currentPageAriaLabel:e.pageAriaLabel,l),onClick:m=>U(m,l)}}}})),h=P(()=>{const l=!!e.disabled||s.value<=v.value,u=!!e.disabled||s.value>=v.value+g.value-1;return{first:e.showFirstLastPage?{icon:o.value?e.lastIcon:e.firstIcon,onClick:d=>U(d,v.value,"first"),disabled:l,ariaLabel:r(e.firstAriaLabel),ariaDisabled:l}:void 0,prev:{icon:o.value?e.nextIcon:e.prevIcon,onClick:d=>U(d,s.value-1,"prev"),disabled:l,ariaLabel:r(e.previousAriaLabel),ariaDisabled:l},next:{icon:o.value?e.prevIcon:e.nextIcon,onClick:d=>U(d,s.value+1,"next"),disabled:u,ariaLabel:r(e.nextAriaLabel),ariaDisabled:u},last:e.showFirstLastPage?{icon:o.value?e.firstIcon:e.lastIcon,onClick:d=>U(d,v.value+g.value-1,"last"),disabled:u,ariaLabel:r(e.lastAriaLabel),ariaDisabled:u}:void 0}});function N(){var u;const l=s.value-v.value;(u=W.value[l])==null||u.$el.focus()}function Q(l){l.key===M.left&&!e.disabled&&s.value>+e.start?(s.value=s.value-1,B(N)):l.key===M.right&&!e.disabled&&s.value<v.value+g.value-1&&(s.value=s.value+1,B(N))}return ve(()=>i(e.tag,{ref:j,class:["v-pagination",I.value,e.class],style:e.style,role:"navigation","aria-label":r(e.ariaLabel),onKeydown:Q,"data-test":"v-pagination-root"},{default:()=>[i("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&i("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[a.first?a.first(h.value.first):i(b,k({_as:"VPaginationBtn"},h.value.first),null)]),i("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[a.prev?a.prev(h.value.prev):i(b,k({_as:"VPaginationBtn"},h.value.prev),null)]),J.value.map((l,u)=>i("li",{key:l.key,class:["v-pagination__item",{"v-pagination__item--is-active":l.isActive}],"data-test":"v-pagination-item"},[a.item?a.item(l):i(b,k({_as:"VPaginationBtn"},l.props),{default:()=>[l.page]})])),i("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[a.next?a.next(h.value.next):i(b,k({_as:"VPaginationBtn"},h.value.next),null)]),e.showFirstLastPage&&i("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[a.last?a.last(h.value.last):i(b,k({_as:"VPaginationBtn"},h.value.last),null)])])]})),{}}}),qe=E("h1",null,"Users",-1),ze={class:"text-capitalize"},Ge={class:"text-capitalize"};function Oe(e,t,a,n,s,r){const V=O("v-data-table-server");return $(),fe(me,null,[i(ye,{modelValue:e.updatelUserDialog,"onUpdate:modelValue":t[3]||(t[3]=o=>e.updatelUserDialog=o),persistent:"","max-width":"300"},{default:c(()=>[e.user?($(),K(Se,{key:0},{default:c(()=>[i(Pe,null,{default:c(()=>[L("Update User")]),_:1}),i(Ve,null,{default:c(()=>[L(x(e.user.fullName),1)]),_:1}),i(Ue,null,{default:c(()=>[i(q,{modelValue:e.status,"onUpdate:modelValue":t[0]||(t[0]=o=>e.status=o),items:["active","inactive","blocked"],variant:"outlined",placeholder:"Select status",label:"Status"},null,8,["modelValue"]),i(q,{modelValue:e.role,"onUpdate:modelValue":t[1]||(t[1]=o=>e.role=o),items:["admin","user","creator"],variant:"outlined",placeholder:"Role",label:"Select role"},null,8,["modelValue"])]),_:1}),i(_e,{class:"text-right"},{default:c(()=>[i(b,{color:"red",variant:"text",onClick:r.saveUser},{default:c(()=>[L("Save")]),_:1},8,["onClick"]),i(b,{color:"green",variant:"text",onClick:t[2]||(t[2]=o=>e.updatelUserDialog=!1)},{default:c(()=>[L("Cancel")]),_:1})]),_:1})]),_:1})):pe("",!0)]),_:1},8,["modelValue"]),i(F,null,{default:c(()=>[i(z,null,{default:c(()=>[i(C,{cols:"4"},{default:c(()=>[qe]),_:1}),i(C,{cols:"8"},{default:c(()=>[i(ke,{placeholder:"Search users","prepend-icon":"mdi-magnify",onKeyup:r.searchUser},null,8,["onKeyup"])]),_:1})]),_:1}),i(V,{page:e.page,"onUpdate:page":t[4]||(t[4]=o=>e.page=o),"fixed-header":"",headers:e.headers,items:e.userPage.docs,"items-per-page":e.limit,"items-length":e.userPage.totalDocs,loading:e.loading,"loading-text":"Fetching users...","no-data-text":"No users to display",class:"elevation-1","onUpdate:options":r.setOptions},{"item.createdAt":c(({item:o})=>[L(x(r.readableDate(o.createdAt,"MMM Do, YYYY h:mmA")),1)]),"item.role":c(({item:o})=>[E("span",ze,x(o.role),1)]),"item.status":c(({item:o})=>[E("span",Ge,x(o.status),1)]),"item.action":c(({item:o})=>[i(b,{size:"x-small",color:"blue",icon:"mdi-pencil",title:"Deactivate User",onClick:I=>r.update(o)},null,8,["onClick"])]),_:2},1032,["page","headers","items","items-per-page","items-length","loading","onUpdate:options"]),i(z,{justify:"center"},{default:c(()=>[i(C,{cols:"8"},{default:c(()=>[i(F,{class:"max-width"},{default:c(()=>[i(Fe,{modelValue:e.page,"onUpdate:modelValue":t[5]||(t[5]=o=>e.page=o),class:"my-4",length:e.totalPages},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1})],64)}const Ke=G(we,[["render",Oe]]),Ye={name:"UserView",components:{UserList:Ke}};function je(e,t,a,n,s,r){const V=O("user-list");return $(),K(V)}const va=G(Ye,[["render",je]]);export{va as default};
